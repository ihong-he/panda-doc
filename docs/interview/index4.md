---
outline: deep
---

# ğŸš€ Vue.jsæ ¸å¿ƒæŒ‡å—

::: tip ğŸ“š é¢è¯•å°è´´å£«
æœ¬æ–‡æ¡£ä¸“ä¸ºå‡†å¤‡Vue.jsé¢è¯•çš„åŒå­¦æ‰“é€ ï¼Œè¦†ç›–Vue2/Vue3æœ€æ ¸å¿ƒçš„çŸ¥è¯†ç‚¹ï¼Œå¸®ä½ å¿«é€ŸæŒæ¡ä¼ä¸šé¢è¯•é‡ç‚¹ï¼
:::

## ğŸ“‘ ç›®å½•è¡¨
[[toc]]

## ğŸ—ï¸ ä¸€ã€VueåŸºç¡€

### 1ã€MVVMæ˜¯ä»€ä¹ˆï¼ŸVueæ€ä¹ˆå®ç°çš„ï¼Ÿ

> ğŸ’¡ **é€šä¿—ç†è§£**ï¼šMVVMå°±æ˜¯æ•°æ®æ¨¡å‹(Model)ã€è§†å›¾(View)ã€è§†å›¾æ¨¡å‹(ViewModel)ä¸‰å±‚æ¶æ„ã€‚

- **Model**ï¼šæ•°æ®å±‚ï¼Œå°±æ˜¯å’±ä»¬å®šä¹‰çš„æ•°æ®
- **View**ï¼šè§†å›¾å±‚ï¼Œå°±æ˜¯ç”¨æˆ·çœ‹åˆ°çš„é¡µé¢  
- **ViewModel**ï¼šè¿æ¥å±‚ï¼ŒVueåšçš„å°±æ˜¯è¿™äº‹ï¼Œè®©æ•°æ®å˜åŒ–è‡ªåŠ¨æ›´æ–°è§†å›¾

::: warning ğŸ”¥ é¢è¯•è¦ç‚¹
**Vue3å®ç°åŸç†**ï¼šé€šè¿‡Proxyä»£ç†æ•°æ®å¯¹è±¡ï¼Œå½“æ•°æ®å˜åŒ–æ—¶è‡ªåŠ¨æ›´æ–°è§†å›¾ã€‚ä½ æ”¹æ•°æ®ï¼Œé¡µé¢è‡ªåŠ¨è·Ÿç€å˜ï¼Œä¸ç”¨æ‰‹åŠ¨æ“ä½œDOMã€‚
:::

---

### 2ã€Vue3å’ŒVue2æ ¸å¿ƒåŒºåˆ«ï¼ˆğŸ”¥ é¢è¯•é‡ç‚¹ï¼‰

::: danger ğŸ“š å¿…èƒŒçŸ¥è¯†ç‚¹
è¿™éƒ¨åˆ†æ˜¯é¢è¯•é«˜é¢‘è€ƒç‚¹ï¼Œå¿…é¡»ç†Ÿç»ƒæŒæ¡ï¼
:::

**âš¡ å“åº”å¼åŸç†**ï¼ˆå¿…è€ƒç‚¹ï¼‰ï¼š
- **Vue2**ç”¨`Object.defineProperty`ï¼Œåªèƒ½ç›‘å¬å·²æœ‰å±æ€§ï¼Œæ–°å¢å±æ€§è¦`Vue.set`
- **Vue3**ç”¨`Proxy`ï¼Œèƒ½ç›‘å¬æ•´ä¸ªå¯¹è±¡ï¼Œæ–°å¢å±æ€§è‡ªåŠ¨å“åº”å¼

**âœ¨ å†™æ³•å˜åŒ–**ï¼š
- **Vue2**ä¸»è¦æ˜¯é€‰é¡¹å¼APIï¼ˆdataã€methodsåˆ†å¼€å†™ï¼‰
- **Vue3**æ¨èç»„åˆå¼APIï¼ˆsetupè¯­æ³•ç³–ï¼‰ï¼Œç›¸å…³é€»è¾‘æ”¾ä¸€èµ·ï¼Œä»£ç æ›´æ¸…çˆ½

**ğŸš€ æ€§èƒ½æå‡**ï¼š
- **Vue3**ç¼–è¯‘ä¼˜åŒ–æ›´å¥½ï¼Œdiffç®—æ³•æ›´æ™ºèƒ½ï¼Œ**é™æ€èŠ‚ç‚¹ä¸é‡æ–°æ¸²æŸ“**
- æ”¯æŒTree-shakingï¼ŒæŒ‰éœ€å¼•å…¥ï¼Œ**æ‰“åŒ…ä½“ç§¯æ›´å°**

**ğŸ‰ Vue3æ–°ç‰¹æ€§**ï¼š
- ğŸŒ³ **å¤šæ ¹èŠ‚ç‚¹**ï¼ˆä¸ç”¨å¥—ä¸€å±‚divï¼‰
- ğŸšª **Teleportç»„ä»¶**ï¼ˆä¼ é€åˆ°DOMä»»æ„ä½ç½®ï¼‰
- ğŸ”§ **Composition API**ï¼ˆé€»è¾‘å¤ç”¨æ›´æ–¹ä¾¿ï¼‰

::: tip ğŸ’¬ é¢è¯•å›ç­”æŠ€å·§
**ğŸ¯ å›ç­”æ¡†æ¶**ï¼š
å“åº”å¼åŸç† â†’ å†™æ³•å˜åŒ– â†’ æ€§èƒ½æå‡ â†’ æ–°ç‰¹æ€§
:::

---

### 3ã€VueåŒå‘ç»‘å®šåº•å±‚åŸç†ï¼ˆğŸ”¥ é«˜é¢‘é¢˜ï¼‰

::: danger âš ï¸ æ ¸å¿ƒè€ƒç‚¹
è¿™æ˜¯Vueé¢è¯•å¿…è€ƒé¢˜ï¼Œå¿…é¡»èƒ½è¯´æ¸…æ¥šä¸¤ä¸ªç‰ˆæœ¬çš„å®ç°å·®å¼‚ï¼
:::

**ğŸ“± Vue2ï¼ˆObject.definePropertyï¼‰**ï¼š
- é€šè¿‡`Object.defineProperty`æŠŠæ•°æ®å±æ€§è½¬æˆ`getter/setter`
- è¯»å–æ•°æ®æ—¶æ”¶é›†ä¾èµ–ï¼ˆå“ªä¸ªç»„ä»¶ç”¨äº†è¿™æ•°æ®ï¼‰
- ä¿®æ”¹æ•°æ®æ—¶é€šçŸ¥ä¾èµ–çš„ç»„ä»¶æ›´æ–°

**ğŸš€ Vue3ï¼ˆProxyï¼‰**ï¼š
- ç”¨`Proxy`ä»£ç†æ•´ä¸ªå¯¹è±¡
- è¯»å–æ—¶`get`æ“ä½œæ”¶é›†ä¾èµ–
- ä¿®æ”¹æ—¶`set`æ“ä½œè§¦å‘æ›´æ–°
- æ¯”Vue2æ›´å¼ºå¤§ï¼Œèƒ½ç›‘å¬æ•°ç»„ã€æ–°å¢å±æ€§ç­‰

> ğŸ’¡ **ä¸€å¥è¯æ€»ç»“**ï¼šæ•°æ®å˜åŒ–æ—¶è‡ªåŠ¨æ›´æ–°è§†å›¾ï¼ŒVue2é definePropertyï¼ŒVue3é Proxyã€‚

::: tip ğŸ’¬ é¢è¯•å›ç­”æŠ€å·§
é‡ç‚¹è¯´æ˜Vue3çš„Proxyæ¯”Vue2çš„definePropertyæ›´å¼ºå¤§ï¼Œèƒ½è§£å†³æ›´å¤šè¾¹ç•Œé—®é¢˜ï¼
:::

---

### 4ã€Vueå¸¸ç”¨æŒ‡ä»¤ï¼ˆğŸ¯ è®°ä½è¿™å‡ ä¸ªå°±å¤Ÿäº†ï¼‰

::: tip ğŸ“š æŒ‡ä»¤è®°å¿†æ³•
VueæŒ‡ä»¤å°±æ˜¯ä»¥`v-`å¼€å¤´çš„ç‰¹æ®Šå±æ€§ï¼Œç¼©å†™è®©ä»£ç æ›´ç®€æ´ï¼
:::

**ğŸ”¥ å¿…çŸ¥æŒ‡ä»¤**ï¼ˆé¢è¯•å¸¸è€ƒï¼‰ï¼š
- `v-bind`ï¼šç¼©å†™`:`ï¼Œç»‘å®šå±æ€§ï¼ˆå¦‚`:class="active"`ï¼‰
- `v-on`ï¼šç¼©å†™`@`ï¼Œç»‘å®šäº‹ä»¶ï¼ˆå¦‚`@click="handleClick"`ï¼‰
- `v-model`ï¼šåŒå‘ç»‘å®šï¼Œè¡¨å•ç”¨å¾—å¤š
- `v-for`ï¼šå¾ªç¯æ¸²æŸ“ï¼ˆ**è®°å¾—åŠ `:key`**ï¼‰
- `v-if`/`v-else`ï¼šæ¡ä»¶æ¸²æŸ“
- `v-show`ï¼šæ˜¾ç¤ºéšè—ï¼ˆdisplay:noneï¼‰

**âš ï¸ é‡è¦æé†’**ï¼š
- `v-for` å¿…é¡»åŠ `:key`ï¼Œç”¨å”¯ä¸€ç¨³å®šçš„å€¼ï¼ˆå¦‚idï¼‰
- `v-if` vs `v-show`ï¼šé¢‘ç¹åˆ‡æ¢ç”¨`v-show`ï¼Œæ¡ä»¶åŸºæœ¬ä¸å˜ç”¨`v-if`

**ğŸ“š ä¸å¸¸ç”¨ä½†è¦çŸ¥é“**ï¼š
- `v-once`ï¼šåªæ¸²æŸ“ä¸€æ¬¡ï¼Œé€‚åˆé™æ€å†…å®¹
- `v-pre`ï¼šè·³è¿‡ç¼–è¯‘ï¼Œæ˜¾ç¤ºåŸå§‹`{{ }}`
- `v-cloak`ï¼šé˜²æ­¢é¡µé¢é—ªçƒï¼Œé…åˆCSSä½¿ç”¨

> ğŸ’¡ **é¢è¯•é‡ç‚¹**ï¼šé‡ç‚¹æŒæ¡å‰6ä¸ªå¸¸ç”¨æŒ‡ä»¤ï¼Œèƒ½è¯´å‡ºç¼©å†™å’Œä½¿ç”¨åœºæ™¯ï¼

---

### 5ã€v-ifå’Œv-showçš„åŒºåˆ«ï¼ˆğŸ”¥ ç»å…¸é¢è¯•é¢˜ï¼‰

::: danger âš ï¸ å¿…è€ƒåŒºåˆ«
è¿™æ˜¯Vueç»å…¸é¢è¯•é¢˜ï¼Œå¿…é¡»èƒ½è¯´æ¸…æ¥šæ€§èƒ½å·®å¼‚å’Œä½¿ç”¨åœºæ™¯ï¼
:::

**ğŸ”„ æ ¸å¿ƒåŒºåˆ«**ï¼š
- `v-if`ï¼š**åŸºäºæ¡ä»¶æ¸²æŸ“**ï¼Œæ¡ä»¶ä¸ºfalseæ—¶å…ƒç´ å®Œå…¨ä»DOMä¸­ç§»é™¤
- `v-show`ï¼š**åŸºäºCSSæ˜¾éš**ï¼Œå…ƒç´ å§‹ç»ˆä¿ç•™åœ¨DOMä¸­ï¼Œé€šè¿‡`display`å±æ€§æ§åˆ¶å¯è§æ€§

**âš¡ é€‰æ‹©åŸåˆ™**ï¼š
- **é¢‘ç¹åˆ‡æ¢ç”¨`v-show`**ï¼ˆæˆæœ¬å°ï¼‰
- **æ¡ä»¶åŸºæœ¬ä¸å˜ç”¨`v-if`**ï¼ˆåˆå§‹æ¸²æŸ“æˆæœ¬ä½ï¼‰

::: tip ğŸ’¬ é¢è¯•åŠ åˆ†é¡¹
`v-if`æœ‰æ›´é«˜çš„åˆ‡æ¢å¼€é”€ï¼Œ`v-show`æœ‰æ›´é«˜çš„åˆå§‹æ¸²æŸ“å¼€é”€ã€‚èƒ½è¯´å‡ºè¿™ä¸€ç‚¹è¯´æ˜ä½ ç†è§£å¾ˆæ·±å…¥ï¼
:::

---

### 6ã€dataä¸ºä»€ä¹ˆå¿…é¡»æ˜¯å‡½æ•°ï¼ˆğŸ¤” æ€è€ƒé¢˜ï¼‰

::: warning ğŸ“š æ ¸å¿ƒåŸç†
è¿™é“é¢˜è€ƒå¯Ÿå¯¹Vue2ç»„ä»¶å®ä¾‹åŒ–æœºåˆ¶çš„ç†è§£ï¼
:::

> ğŸ¤” **æ ¸å¿ƒåŸå› **ï¼šä¿è¯æ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½æœ‰**ç‹¬ç«‹**çš„æ•°æ®å¯¹è±¡ï¼Œé¿å…æ•°æ®æ±¡æŸ“ï¼

**ğŸ’¡ ä¸¾ä¾‹è¯´æ˜**ï¼š
- å¦‚æœdataæ˜¯å¯¹è±¡ï¼Œæ‰€æœ‰ç»„ä»¶å®ä¾‹**å…±äº«åŒä¸€ä¸ªå¯¹è±¡**ï¼Œä¸€ä¸ªæ”¹äº†éƒ½å—å½±å“
- å¦‚æœdataæ˜¯å‡½æ•°ï¼Œæ¯æ¬¡éƒ½**æ‰§è¡Œå‡½æ•°è¿”å›æ–°å¯¹è±¡**ï¼Œä¿æŒæ•°æ®ç‹¬ç«‹

**ğŸš€ Vue3ä¸­çš„å˜åŒ–**ï¼š
- ä¸ç”¨å†™dataå‡½æ•°äº†ï¼Œç›´æ¥å†™`const count = ref(0)`
- ä½†åŸç†ä¸€æ ·ï¼Œ**æ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½æœ‰è‡ªå·±çš„å“åº”å¼æ•°æ®**

::: tip ğŸ’¬ é¢è¯•å›ç­”è¦ç‚¹
1. ä¿è¯æ•°æ®ç‹¬ç«‹æ€§
2. é¿å…ç»„ä»¶é—´æ•°æ®æ±¡æŸ“  
3. ç¬¦åˆç»„ä»¶åŒ–æ€æƒ³
4. Vue3ä¸­åŸç†ç›¸åŒï¼Œå†™æ³•æ›´ç®€æ´
:::

---

### 7ã€Vueç”Ÿå‘½å‘¨æœŸï¼ˆğŸ“… å¿…èƒŒæ—¶é—´çº¿ï¼‰

::: tip â° ç”Ÿå‘½å‘¨æœŸç†è§£
ç”Ÿå‘½å‘¨æœŸå°±åƒç»„ä»¶ä»"å‡ºç”Ÿ"åˆ°"æ­»äº¡"çš„å…¨è¿‡ç¨‹ï¼Œæ¯ä¸ªé˜¶æ®µéƒ½æœ‰å¯¹åº”çš„é’©å­å‡½æ•°ï¼
:::

**ğŸŸ¢ Vue2æ—¶æœŸ**ï¼ˆäº†è§£å³å¯ï¼‰ï¼š
- `created`ï¼šåˆ›å»ºé˜¶æ®µï¼Œæ•°æ®æœ‰äº†ï¼ŒDOMè¿˜æ²¡æŒ‚è½½
- `mounted`ï¼šæŒ‚è½½é˜¶æ®µï¼ŒDOMæŒ‚è½½å®Œäº†
- `updated`ï¼šæ›´æ–°é˜¶æ®µï¼Œæ•°æ®æ›´æ–°äº†ï¼ŒDOMä¹Ÿæ›´æ–°äº†
- `destroyed`ï¼šé”€æ¯é˜¶æ®µï¼Œç»„ä»¶é”€æ¯äº†

**ğŸ”µ Vue3é‡ç‚¹**ï¼ˆsetupè¯­æ³•ç³–å†™æ³•ï¼‰ï¼š
```javascript
import { onMounted, onUpdated, onUnmounted } from 'vue'

// ğŸ¯ åˆ›å»ºå®Œï¼šæ•°æ®å·²ç»åˆ›å»ºå¥½ï¼ŒDOMè¿˜æ²¡æŒ‚è½½ 
// setup æ›¿ä»£ beforeCreate/created
setup() { }

// ğŸ¯ æŒ‚è½½å®Œï¼šDOMå·²ç»æ¸²æŸ“å¥½äº†
onMounted(() => {
  // è·å–DOMã€å‘è¯·æ±‚
  console.log('DOMæŒ‚è½½å®Œæˆ')
})

// ğŸ”„ æ›´æ–°å®Œï¼šDOMé‡æ–°æ¸²æŸ“å
onUpdated(() => {
  // DOMæ›´æ–°åçš„æ“ä½œ
  console.log('DOMæ›´æ–°å®Œæˆ')
})

// ğŸ§¹ é”€æ¯å‰ï¼šç»„ä»¶å³å°†é”€æ¯
onBeforeUnmount(() => {
  // æ¸…ç†å®šæ—¶å™¨ã€è§£ç»‘äº‹ä»¶
  console.log('ç»„ä»¶å³å°†é”€æ¯')
})

// ğŸ§¹ å·²é”€æ¯ï¼šç»„ä»¶å·²å®Œå…¨é”€æ¯
onUnmounted(() => {
  // æ­¤æ—¶DOMå·²è¢«ç§»é™¤
  console.log('ç»„ä»¶å·²é”€æ¯')
})
```

**âš¡ ä½¿ç”¨åœºæ™¯**ï¼š
- `onMounted`ï¼šè·å–DOMå…ƒç´ ã€å‘ajaxè¯·æ±‚
- `onBeforeUnmount`ï¼šæ¸…ç†å®šæ—¶å™¨ã€å–æ¶ˆäº‹ä»¶ç›‘å¬ï¼ˆåœ¨DOMç§»é™¤å‰æ‰§è¡Œï¼‰
- `onUnmounted`ï¼šæœ€åæ¸…ç†å·¥ä½œï¼ˆæ­¤æ—¶DOMå·²ç§»é™¤ï¼‰

::: tip ğŸ’¡ **é¢è¯•é‡ç‚¹**
Vue3ä¸­ä¸»è¦æŒæ¡`onMounted`ã€`onUpdated`ã€`onUnmounted`ä¸‰ä¸ªå°±å¤Ÿäº†ï¼Œå…¶ä»–çš„å¾ˆå°‘ç”¨ï¼
:::
---

### 8ã€ç»„ä»¶é€šä¿¡æ–¹å¼ï¼ˆğŸ”— Vueé‡ç‚¹ï¼‰

::: danger ğŸ“š æ ¸å¿ƒè€ƒç‚¹
ç»„ä»¶é€šä¿¡æ˜¯Vueå¼€å‘çš„å¿…å¤‡æŠ€èƒ½ï¼Œå¿…é¡»æŒæ¡å¤šç§æ–¹æ¡ˆï¼
:::

**ğŸ“¡ 1. çˆ¶å­é€šä¿¡**ï¼ˆğŸ”¥ æœ€å¸¸ç”¨ï¼‰

ğŸ“Œ çˆ¶ä¼ å­ - props

> ğŸ’¬ **è¦ç‚¹**ï¼šçˆ¶ç»„ä»¶ç”¨`v-bind`ç»‘å®šæ•°æ®ï¼Œå­ç»„ä»¶ç”¨`defineProps`æ¥æ”¶
::: code-group
```jsx [çˆ¶ç»„ä»¶]
// çˆ¶ç»„ä»¶ä¼ é€’
<Child :msg="data" />
```

```jsx [å­ç»„ä»¶]
// å­ç»„ä»¶æ¥æ”¶
const props = defineProps(['msg'])
```
:::
ğŸ“Œ å­ä¼ çˆ¶ - è‡ªå®šä¹‰äº‹ä»¶

> ğŸ’¬ **è¦ç‚¹**ï¼šå­ç»„ä»¶é€šè¿‡`defineEmits`è‡ªå®šä¹‰äº‹ä»¶ï¼Œ`emit`è§¦å‘å¹¶ä¼ æ•°æ®ï¼Œçˆ¶ç»„ä»¶ä½¿ç”¨`@`ç›‘å¬

::: code-group
```jsx [å­ç»„ä»¶]
// å­ç»„ä»¶è§¦å‘
const emit = defineEmits(['update']);
emit('update', value)
```
```jsx [çˆ¶ç»„ä»¶]
// çˆ¶ç»„ä»¶ç›‘å¬
<Child @update="handleUpdate" />
```
:::

**ğŸŒ‰ 2. è·¨å±‚çº§é€šä¿¡**ï¼š
- `provide`/`inject`ï¼šçˆ·å­™ç»„ä»¶é€šä¿¡
- EventBusï¼ˆVue3ä¸æ¨èï¼‰

**ğŸŒ 3. å…¨å±€çŠ¶æ€ç®¡ç†**ï¼š
- å°é¡¹ç›®ï¼šåˆ›å»ºä¸€ä¸ªå“åº”å¼å¯¹è±¡å¯¼å‡º
- å¤§é¡¹ç›®ï¼šç”¨Piniaï¼ˆå®˜æ–¹æ¨èï¼‰

**ğŸ“Œ Vue2 ç»„ä»¶é€šä¿¡æ–¹å¼è¡¥å……**ï¼ˆäº†è§£å³å¯ï¼‰ï¼š
- çˆ¶ä¼ å­ï¼š`props`
- å­ä¼ çˆ¶ï¼šè‡ªå®šä¹‰äº‹ä»¶ï¼ˆ`this.$emit`ï¼‰
- è·¨å±‚çº§ï¼š`EventBus`ï¼ˆ`new Vue()`ï¼‰
- çŠ¶æ€ç®¡ç†ï¼šVuexï¼ˆVue2å®˜æ–¹æ¨èï¼‰

::: warning âš ï¸ æ³¨æ„
Vue2çš„å†™æ³•å·²è¿‡æ—¶ï¼Œé¢è¯•ç®€å•äº†è§£å³å¯ï¼Œé‡ç‚¹æŒæ¡Vue3æ–°å†™æ³•ï¼
:::

---

### 9ã€v-forä¸­çš„keyä¸ºä»€ä¹ˆé‡è¦ï¼ˆğŸ”‘ å¿…æ‡‚åŸç†ï¼‰

::: warning âš ï¸ æ€§èƒ½å…³é”®
keyçš„ä½œç”¨ç›´æ¥å½±å“Vueçš„diffç®—æ³•æ€§èƒ½ï¼Œå¿…é¡»ç†è§£ï¼
:::

ğŸ’¬ **ä¸€å¥è¯æ€»ç»“**ï¼š

**keyçš„ä¸»è¦ä½œç”¨æ˜¯å¸®åŠ©Vueï¼ˆåœ¨è™šæ‹ŸDOM diffæ—¶ï¼‰å‡†ç¡®è¯†åˆ«å…ƒç´ ï¼Œæé«˜æ¸²æŸ“æ€§èƒ½ã€‚**

å¦‚æœä¸åŠ keyï¼ŒVueé»˜è®¤ç”¨æ•°ç»„ä¸‹æ ‡ä½œä¸ºæ ‡è¯†ï¼Œå½“æ•°ç»„å…ƒç´ ä½ç½®å˜åŒ–æ—¶ï¼Œå¯èƒ½ä¼šå¤ç”¨é”™è¯¯çš„DOMå…ƒç´ ï¼Œå¯¼è‡´çŠ¶æ€é”™ä¹±ã€‚

ä½¿ç”¨keyæ—¶ï¼Œå»ºè®®ç”¨æ•°æ®çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆå¦‚idï¼‰ï¼Œä¸è¦ç”¨ä¸‹æ ‡æˆ–éšæœºæ•°ã€‚è¿™æ ·Vueå°±èƒ½å‡†ç¡®æ‰¾åˆ°å¯¹åº”çš„å…ƒç´ è¿›è¡Œæ›´æ–°æˆ–ç§»åŠ¨ï¼Œé¿å…ä¸å¿…è¦çš„DOMåˆ›å»ºå’Œé”€æ¯ã€‚"

::: tip ğŸ’¬ é¢è¯•å›ç­”æŠ€å·§
1. keyå¸®åŠ©Vueè¯†åˆ«å…ƒç´ èº«ä»½
2. é¿å…ä¸å¿…è¦çš„DOMåˆ›å»ºå’Œé”€æ¯
3. æé«˜diffç®—æ³•æ€§èƒ½
:::
---

### 10ã€computedå’Œwatchçš„åŒºåˆ«ï¼ˆğŸ”¥ å¿…è€ƒå¯¹æ¯”ï¼‰

::: danger ğŸ“š é«˜é¢‘è€ƒç‚¹
computedå’Œwatchçš„åŒºåˆ«æ˜¯Vueé¢è¯•å¿…è€ƒé¢˜ï¼Œå¿…é¡»èƒ½è¯´æ¸…æ¥šä½¿ç”¨åœºæ™¯ï¼
:::

**ğŸ§® computedï¼ˆè®¡ç®—å±æ€§ï¼‰**ï¼š
- **æœ‰ç¼“å­˜**ï¼Œä¾èµ–ä¸å˜å°±ä¸é‡æ–°è®¡ç®—
- é€‚åˆæ ¹æ®ç°æœ‰æ•°æ®è®¡ç®—æ–°æ•°æ®
- **å¿…é¡»æœ‰è¿”å›å€¼**

**ğŸ‘ï¸ watchï¼ˆç›‘å¬å™¨ï¼‰**ï¼š
- **æ²¡ç¼“å­˜**ï¼Œæ•°æ®å˜å°±æ‰§è¡Œ
- é€‚åˆæ•°æ®å˜åŒ–æ—¶åšå‰¯ä½œç”¨ï¼ˆå‘è¯·æ±‚ã€DOMæ“ä½œï¼‰
- **å¯ä»¥æ‰§è¡Œå¼‚æ­¥æ“ä½œ**

**ğŸ¤– Vue3æ–°å¢**ï¼š
- `watchEffect`ï¼š**è‡ªåŠ¨æ”¶é›†ä¾èµ–**ï¼Œä¸ç”¨æ‰‹åŠ¨æŒ‡å®šç›‘å¬è°
- `computed`å†™æ³•æ›´ç®€æ´ï¼š`const doubleCount = computed(() => count.value * 2)`

**ğŸ¯ é€‰æ‹©åŸåˆ™**ï¼š
- **æƒ³ç¼“å­˜ã€æœ‰è¿”å›å€¼ç”¨computed**
- **æƒ³åšå‰¯ä½œç”¨ã€å¼‚æ­¥æ“ä½œç”¨watch**

::: tip ğŸ’¬ é¢è¯•å›ç­”æŠ€å·§
é‡ç‚¹è¯´computedçš„ç¼“å­˜ç‰¹æ€§å’Œwatchçš„å‰¯ä½œç”¨ç‰¹æ€§ï¼ŒåŠ ä¸ŠVue3çš„watchEffectæ–°ç‰¹æ€§ä¼šè®©å›ç­”æ›´å®Œæ•´ï¼
:::

---

### 11ã€keep-aliveæ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆç”¨ï¼ˆğŸ“¦ ç»„ä»¶ç¼“å­˜ç¥å™¨ï¼‰

::: tip ğŸš€ æ€§èƒ½ä¼˜åŒ–
keep-aliveæ˜¯Vueå†…ç½®çš„æ€§èƒ½ä¼˜åŒ–ç»„ä»¶ï¼Œé¢è¯•å¿…è€ƒï¼
:::

> ğŸ“¦ **keep-aliveä½œç”¨**ï¼šç¼“å­˜ä¸æ´»åŠ¨çš„ç»„ä»¶å®ä¾‹ï¼Œé¿å…é‡å¤æ¸²æŸ“ï¼Œ**æå‡æ€§èƒ½**ï¼

**ğŸ’» åŸºæœ¬ç”¨æ³•**ï¼š
```vue
<keep-alive :include="['User', 'Post']" :max="10">
  <router-view />
</keep-alive>
```

**âš™ï¸ å±æ€§è¯´æ˜**ï¼š
- `include`ï¼ˆ/ÉªnËˆkluËd/ï¼‰ï¼šæŒ‡å®šå“ªäº›ç»„ä»¶éœ€è¦ç¼“å­˜ï¼ˆä¼ å…¥ç»„ä»¶åæ•°ç»„ï¼‰
- `exclude`ï¼ˆ/ÉªkËˆskluËd/ï¼‰ï¼šæŒ‡å®šå“ªäº›ç»„ä»¶ä¸éœ€è¦ç¼“å­˜ï¼ˆä¼ å…¥ç»„ä»¶åæ•°ç»„ï¼‰
- `max`ï¼šæœ€å¤šç¼“å­˜å¤šå°‘ä¸ªç»„ä»¶å®ä¾‹

**ğŸ”„ ç”Ÿå‘½å‘¨æœŸé’©å­**ï¼š
- `activated`ï¼šç»„ä»¶è¢«æ¿€æ´»æ—¶
- `deactivated`ï¼šç»„ä»¶è¢«ç¼“å­˜æ—¶

**ğŸŒŸ ä¸»è¦ä½¿ç”¨åœºæ™¯**ï¼š
- **tabåˆ‡æ¢é¡µé¢**
- **åˆ—è¡¨è¿›å…¥è¯¦æƒ…å†è¿”å›**
- **ä»»ä½•éœ€è¦ä¿æŒçŠ¶æ€çš„é¡µé¢åˆ‡æ¢**

**âš ï¸ é¢è¯•é‡ç‚¹**ï¼šç¼“å­˜åçš„ç»„ä»¶ä¸ä¼šè§¦å‘`mounted`ï¼Œè€Œæ˜¯è§¦å‘`activated`ï¼

---

### 12ã€nextTickçš„ä½œç”¨å’Œä½¿ç”¨ï¼ˆâ° å¼‚æ­¥æ›´æ–°åˆ©å™¨ï¼‰

::: warning â° å¼‚æ­¥æœºåˆ¶
nextTickè€ƒå¯Ÿå¯¹Vueå¼‚æ­¥æ›´æ–°æœºåˆ¶çš„ç†è§£ï¼Œå¿…è€ƒï¼
:::

> â° **nextTickæ ¸å¿ƒä½œç”¨**ï¼š**è·å–æœ€æ–°çš„DOMæ•°æ®**ï¼Œè§£å†³å¼‚æ­¥æ›´æ–°é—®é¢˜ï¼

**ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦nextTickï¼Ÿ**
- Vueæ›´æ–°DOMæ˜¯**å¼‚æ­¥çš„**ï¼Œæ•°æ®æ”¹å®ŒDOMä¸ä¼šé©¬ä¸Šæ›´æ–°
- ç«‹å³è®¿é—®DOMå¯èƒ½æ‹¿åˆ°çš„æ˜¯**æ—§å€¼**

**ğŸš€ Vue3ç”¨æ³•**ï¼š
```javascript
import { nextTick } from 'vue'

const updateData = async () => {
  count.value++
  await nextTick()
  // è¿™é‡ŒDOMå·²ç»æ›´æ–°å®Œäº†
  console.log(divRef.value.textContent)
}
```

**ğŸ¯ å…¸å‹åœºæ™¯**ï¼š
- æ•°æ®æ›´æ–°åè·å–æœ€æ–°çš„DOMå†…å®¹
- æ“ä½œä¾èµ–æ•°æ®æ›´æ–°åçš„DOM

> ğŸ’¡ **ä¸€å¥è¯æ€»ç»“**ï¼šnextTickè®©ä½ åœ¨DOMçœŸæ­£æ›´æ–°åå†æ‰§è¡Œä»£ç ï¼Œé¿å…æ‹¿åˆ°è¿‡æœŸçš„DOMä¿¡æ¯ï¼


## ğŸŒ äºŒã€Vueç”Ÿæ€

### 1ã€Vue Routerä¼ å‚æ•°æ–¹å¼ï¼ˆğŸ”— è·¯ç”±ä¼ å‚å¤§å…¨ï¼‰

::: tip ğŸ“š è·¯ç”±æ ¸å¿ƒ
Vue Routeræ˜¯Vueçš„å®˜æ–¹è·¯ç”±ç®¡ç†å™¨ï¼Œä¼ å‚æ–¹å¼æ˜¯é«˜é¢‘è€ƒç‚¹ï¼
:::

**ğŸ“ è·¯å¾„å‚æ•°**ï¼ˆåŠ¨æ€è·¯ç”±ï¼‰ï¼š
- ç”¨é€”ï¼šä¼ é€’èµ„æºIDç­‰æ ‡è¯†å‚æ•°
- ç‰¹ç‚¹ï¼šå‚æ•°ç›´æ¥åœ¨URLè·¯å¾„ä¸­ï¼ŒSEOå‹å¥½ï¼Œåˆ·æ–°ä¸ä¸¢å¤±
```javascript
// é…ç½®ï¼š{ path: '/user/:id', component: User }
// è®¿é—®ï¼š/user/123
// è·å–ï¼šthis.$route.params.id
```

**ğŸ” æŸ¥è¯¢å‚æ•°**ï¼ˆURLé—®å·åï¼‰ï¼š
- ç”¨é€”ï¼šä¼ é€’æœç´¢æ¡ä»¶ã€ç­›é€‰å‚æ•°ç­‰
- ç‰¹ç‚¹ï¼šå‚æ•°åœ¨URLé—®å·åï¼Œé€‚åˆå¯é€‰å‚æ•°ï¼Œåˆ·æ–°ä¸ä¸¢å¤±
```javascript
// è®¿é—®ï¼š/search?q=vue&page=1
// è·å–ï¼šthis.$route.query.q
```

**ğŸ Propsä¼ å‚**ï¼ˆè§£è€¦$routerï¼‰ï¼š
- ç”¨é€”ï¼šå°†è·¯ç”±å‚æ•°è§£è€¦ä¸ºç»„ä»¶props
- ç‰¹ç‚¹ï¼šç»„ä»¶å†…éƒ¨ä¸ä¾èµ–$routeï¼Œä¾¿äºæµ‹è¯•å’Œå¤ç”¨
```javascript
// é…ç½®ï¼š{ path: '/user/:id', component: User, props: true }
// ç»„ä»¶å†…ç›´æ¥ç”¨propsæ¥æ”¶ï¼šprops: ['id']
```

**ğŸš€ Vue3 setupå†™æ³•**ï¼š
- `useRoute`ï¼šè·å–å½“å‰è·¯ç”±ä¿¡æ¯å¯¹è±¡
- `useRouter`ï¼šè·å–è·¯ç”±å®ä¾‹ï¼Œç”¨äºè·¯ç”±è·³è½¬
```javascript
import { useRoute, useRouter } from 'vue-router'
const route = useRoute()  // è·å–è·¯ç”±ä¿¡æ¯
const router = useRouter() // è·³è½¬è·¯ç”±
```

> ğŸ’¡ **é€‰æ‹©å»ºè®®**ï¼š
> - **èµ„æºID** â†’ è·¯å¾„å‚æ•° `/user/123`
> - **æœç´¢ç­›é€‰** â†’ æŸ¥è¯¢å‚æ•° `/search?q=vue&tag=tutorial`  
> - **ç»„ä»¶è§£è€¦** â†’ Propsä¼ å‚

::: tip ğŸ’¬ é¢è¯•é‡ç‚¹
é‡ç‚¹æŒæ¡è·¯å¾„å‚æ•°å’ŒæŸ¥è¯¢å‚æ•°çš„åŒºåˆ«ï¼Œä»¥åŠVue3çš„`useRoute`å’Œ`useRouter`ç”¨æ³•ï¼
:::

---

### 2ã€è·¯ç”±å®ˆå«ï¼ˆğŸ›¡ï¸ æƒé™æ§åˆ¶æ ¸å¿ƒï¼‰

::: danger âš ï¸ æƒé™æ§åˆ¶
è·¯ç”±å®ˆå«æ˜¯Vue Routerçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œé¢è¯•å¿…è€ƒæƒé™æ§åˆ¶å®ç°ï¼
:::

**ğŸŒ å…¨å±€å®ˆå«**ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š`beforeEach`

> ğŸ’¬ **è¯´æ˜**ï¼šå¯¹æ‰€æœ‰è·¯ç”±ç”Ÿæ•ˆï¼Œé€šå¸¸ç”¨äºå®ç°å…¨å±€ç™»å½•éªŒè¯å’Œæƒé™æ§åˆ¶ã€‚

```javascript
router.beforeEach((to, from, next) => {
  if (to.meta.requiresAuth && !isLogin) {
    next('/login')
  } else {
    next()
  }
})
```

**ğŸ¯ è·¯ç”±ç‹¬äº«å®ˆå«**ï¼š`beforeEnter`
> ğŸ’¬ **è¯´æ˜**ï¼šåªåœ¨å®šä¹‰å®ƒçš„å•ä¸ªè·¯ç”±ä¸­ç”Ÿæ•ˆï¼Œé€‚åˆç‰¹å®šè·¯ç”±çš„éªŒè¯éœ€æ±‚ã€‚
```javascript
{
  path: '/admin',
  component: Admin,
  beforeEnter: (to, from, next) => {
    // åªæœ‰è¿™ä¸ªè·¯ç”±çš„å®ˆå«
  }
}
```


**ğŸ§© ç»„ä»¶å†…å®ˆå«**ï¼š
> ğŸ’¬ **è¯´æ˜**ï¼šåœ¨ç»„ä»¶å†…éƒ¨å®šä¹‰ï¼Œç”¨äºæ§åˆ¶è¯¥ç»„ä»¶çš„è¿›å…¥ã€æ›´æ–°å’Œç¦»å¼€è¡Œä¸ºã€‚
```javascript
// setupè¯­æ³•ç³–ä¸­ç”¨ä¸äº†ï¼Œäº†è§£å³å¯
beforeRouteEnter // è¿›å…¥å‰
beforeRouteUpdate // å‚æ•°æ›´æ–°æ—¶
beforeRouteLeave // ç¦»å¼€å‰
```


**ğŸš€ å®é™…åº”ç”¨**ï¼šç™»å½•éªŒè¯ã€æƒé™æ§åˆ¶ã€é¡µé¢ç¦»å¼€æé†’ã€‚

> ğŸ’¡ **ä½¿ç”¨åœºæ™¯**ï¼š
> - **ç™»å½•éªŒè¯**ï¼šæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
> - **è§’è‰²æƒé™**ï¼šéªŒè¯ç”¨æˆ·æ˜¯å¦æœ‰è®¿é—®æƒé™
> - **ç¦»å¼€æé†’**ï¼šè¡¨å•æœªä¿å­˜æ—¶æé†’ç”¨æˆ·

::: tip ğŸ’¬ é¢è¯•é‡ç‚¹
é‡ç‚¹æŒæ¡å…¨å±€å‰ç½®å®ˆå«`beforeEach`çš„ä½¿ç”¨ï¼Œä»¥åŠå¦‚ä½•å®ç°ç™»å½•éªŒè¯å’Œæƒé™æ§åˆ¶ï¼
:::

---

### 3ã€hashæ¨¡å¼å’Œhistoryæ¨¡å¼é€‰æ‹©ï¼ˆğŸ›¤ï¸ è·¯ç”±æ¨¡å¼ï¼‰

::: tip ğŸŒ è·¯ç”±é€‰æ‹©
è·¯ç”±æ¨¡å¼é€‰æ‹©å½±å“ç”¨æˆ·ä½“éªŒå’ŒSEOéƒ¨ç½²ï¼Œå¿…é¡»æŒæ¡ï¼
:::

**ğŸ“± hashæ¨¡å¼**ï¼ˆ`#/home`ï¼‰ï¼š
- **å…¼å®¹æ€§å¥½**ï¼Œä¸ç”¨æœåŠ¡å™¨é…ç½®
- URL**ä¸‘**ï¼Œæœ‰#å·
- **SEOä¸å‹å¥½**

**ğŸŒŸ historyæ¨¡å¼**ï¼ˆ`/home`ï¼‰ï¼š
- URL**ç¾è§‚**ï¼Œç¬¦åˆå¸¸è§„è®¤çŸ¥
- **éœ€è¦æœåŠ¡å™¨é…ç½®**ï¼ˆåˆ·æ–°404é—®é¢˜ï¼‰
- **SEOå‹å¥½**

**ğŸ¯ æ€ä¹ˆé€‰**ï¼š
- **ç®€å•é¡¹ç›®ã€æ¼”ç¤ºç”¨hash**
- **æ­£å¼é¡¹ç›®ã€è¦æ±‚SEOç”¨history**
- é…åˆnginxç­‰æœåŠ¡å™¨è§£å†³åˆ·æ–°é—®é¢˜

**âš™ï¸ Vue3ä¸­é…ç½®**ï¼š`createWebHashHistory()`æˆ–`createWebHistory()`

> ğŸ’¡ **é€‰æ‹©å»ºè®®**ï¼š
> - **å¼€å‘æµ‹è¯•**ï¼šhashæ¨¡å¼ï¼ˆæ— éœ€é…ç½®ï¼‰
> - **ç”Ÿäº§ç¯å¢ƒ**ï¼šhistoryæ¨¡å¼ï¼ˆéœ€è¦åç«¯æ”¯æŒï¼‰
> - **ç§»åŠ¨ç«¯H5**ï¼šçœ‹éœ€æ±‚ï¼Œä¸¤è€…çš†å¯

::: warning âš ï¸ é‡è¦æé†’
historyæ¨¡å¼éœ€è¦æœåŠ¡å™¨é…ç½®ï¼Œå¦åˆ™åˆ·æ–°é¡µé¢ä¼šå‡ºç°404ï¼å¸¸è§é…ç½®åœ¨nginxã€Apacheç­‰webæœåŠ¡å™¨ä¸­ã€‚
:::

---

### 4ã€Vuex vs Piniaï¼ˆğŸ“Š çŠ¶æ€ç®¡ç†å¯¹æ¯”ï¼‰

::: danger ğŸ“š çŠ¶æ€ç®¡ç†
çŠ¶æ€ç®¡ç†æ˜¯å¤§å‹é¡¹ç›®çš„æ ¸å¿ƒï¼ŒPiniaæ˜¯Vue3å®˜æ–¹æ¨èï¼
:::

**ğŸ“¦ Vuex**ï¼ˆä¼ ç»Ÿæ–¹æ¡ˆï¼‰ï¼š
- Stateã€Mutationã€Actionã€Moduleã€Getter
- Mutation**å¿…é¡»åŒæ­¥**ï¼ŒActionå¯ä»¥å¼‚æ­¥
- **æäº¤Mutation**ï¼šé€šè¿‡`store.commit('mutationName', payload)`
- **åˆ†å‘Action**ï¼šé€šè¿‡`store.dispatch('actionName', payload)`ï¼Œç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œ

**ğŸ’» VuexåŸºæœ¬ç”¨æ³•**ï¼š
```javascript
// store/index.js
import { createStore } from 'vuex '

export default createStore({
  state: {
    count: 0
  },
  getters: {
    doubleCount: state => state.count * 2
  },
  mutations: {
    increment(state) {
      state.count++
    }
  },
  actions: {
    async incrementAsync({ commit }) {
      // å¼‚æ­¥æ“ä½œ
      await someAsyncOperation()
      commit('increment')
    }
  }
})

// ç»„ä»¶ä¸­ä½¿ç”¨
import { useStore } from 'vuex'
const store = useStore()

// è·å–çŠ¶æ€
console.log(store.state.count)

// è°ƒç”¨getter
console.log(store.getters.doubleCount)

// æäº¤mutation
store.commit('increment')

// åˆ†å‘action
store.dispatch('incrementAsync')
```


**ğŸš€ Pinia**ï¼ˆVue3æ¨èï¼‰ï¼š
- **æ›´ç®€æ´**ï¼Œæ²¡æœ‰Mutation
- **å®Œç¾æ”¯æŒTypeScript**
- **æ”¯æŒDevTools**
- æ¨¡å—åŒ–æ›´è‡ªç„¶

**ğŸ’» PiniaåŸºæœ¬ç”¨æ³•**ï¼š
```javascript
// store/user.js
export const useUserStore = defineStore('user', {
  state: () => ({ name: 'å¼ ä¸‰' }),
  getters: {
    fullName: (state) => state.name + 'å…ˆç”Ÿ'
  },
  actions: {
    async login() {
      // å¯ä»¥å†™å¼‚æ­¥
    }
  }
})

// ç»„ä»¶ä¸­ä½¿ç”¨
const userStore = useUserStore()
```

**ğŸ¯ é€‰æ‹©å»ºè®®**ï¼š
- **Vue3æ–°é¡¹ç›®ç›´æ¥ç”¨Pinia**
- **è€é¡¹ç›®ç»§ç»­ç”¨Vuex**
- **å°é¡¹ç›®å¯ä»¥ç”¨ç®€å•çš„å“åº”å¼å¯¹è±¡**

> ğŸ’¡ **ä¸ºä»€ä¹ˆæ¨èPinia**ï¼š
> - ä»£ç æ›´ç®€æ´ï¼Œæ²¡æœ‰Mutationçš„ç¹ç
> - TypeScriptæ”¯æŒæ›´å¥½
> - æ”¯æŒå¤šä¸ªstoreï¼Œæ¨¡å—åŒ–æ›´æ¸…æ™°
> - Vue3 Composition APIå¤©ç„¶å¥‘åˆ

::: tip ğŸ’¬ é¢è¯•é‡ç‚¹
é‡ç‚¹è¯´æ˜Piniaç›¸æ¯”Vuexçš„ä¼˜åŠ¿ï¼Œä»¥åŠå®ƒä»¬çš„æ ¸å¿ƒåŒºåˆ«ï¼ˆæ˜¯å¦æœ‰Mutationã€TypeScriptæ”¯æŒç­‰ï¼‰ï¼
:::